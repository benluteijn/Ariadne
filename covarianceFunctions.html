<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Covariance functions
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="F# package for Gaussian process regression."/>
    <meta name="author" content="Evelina Gabasova"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

    <link type="text/css" rel="stylesheet" href="/Ariadne/content/style.css" />
    <script type="text/javascript" src="/Ariadne/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://fsharp.org">fsharp.org</a></li>
          <li><a href="http://github.com/evelinag/Ariadne">github page</a></li>
        </ul>
        <h3 class="muted"><a href="/Ariadne/index.html">Ariadne</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1>Covariance functions</h1>

<p>Covariance functions (also called kernels) are the key ingredient in using Gaussian processes. 
They encode all
assumptions about the form of function that we are modelling. In general, covariance represents
some form of distance or similarity. 
Consider two input points (locations) <span class="math">\(x_i\)</span> and <span class="math">\(x_j\)</span> with corresponding observed 
values <span class="math">\(y_i\)</span> and <span class="math">\(y_j\)</span>. If the inputs <span class="math">\(x_i\)</span> and <span class="math">\(x_j\)</span> are close to each other,  we 
generally expect that 
 <span class="math">\(y_i\)</span> and <span class="math">\(y_j\)</span> will be close as well. This measure of similarity is embedded in the covariance
 function.</p>

<p>The Ariadne library currently implements only the squared exponential covariance function.</p>

<h2>Squared exponential kernel</h2>

<p><span class="math">\[k(x_i, x_j) = \sigma^2 \exp\left( - \frac{(x_i - x_j)^2}{2 l^2} \right) + \delta_{ij} \sigma_{\text{noise}}^2\]</span></p>

<p>where <span class="math">\(\sigma^2 &gt; 0\)</span> is the signal variance, <span class="math">\(l &gt; 0\)</span> is the lengthscale and <span class="math">\(\sigma^2_{\text{noise}} &gt;= 0\)</span> is the
noise covariance. The noise variance is applied only when <span class="math">\(i = j\)</span>.</p>

<p>Squared exponential is appropriate for modelling very smooth functions.
The parameters have the following interpretation:</p>

<ul>
<li><p><strong>Lengthscale <span class="math">\(l\)</span></strong> describes how smooth a function is. Small lengthscale value means that function
values can change quickly, large values characterize functions that change only slowly.
Lengthscale also determines how far we can reliably extrapolate from the training data.</p>
<div class="row">
  <div class="span4">
    Small lengthscale
    <img src="img/smallLengthscale.png" />
  </div>
  <div class="span4">
    Large lengthscale
    <img src="img/largeLengthscale.png" />
  </div>
</div></li>
<li><p><strong>Signal variance <span class="math">\(\sigma^2\)</span></strong> is a scaling factor. It determines variation of function values from 
their mean. Small value of <span class="math">\(\sigma^2\)</span> characterize functions that stay close to their mean value,
larger values allow more variation. If the signal variance is too large, the modelled function
will be free to chase outliers.</p>
<div class="row">
  <div class="span4">
    Small signal variance
    <img src="img/smallSignalVariance.png" />
  </div>
  <div class="span4">
    Large signal variance
    <img src="img/largeSignalVariance.png" />
  </div>
</div></li>
<li><p><strong>Noise variance <span class="math">\(\sigma^2_{\text{noise}}\)</span></strong> is formally not a part of the covariance function itself. 
It is used by the Gaussian process model to allow for noise present in training data. This parameter
specifies how much noise is expected to be present in the data.</p>
<div class="row">
  <div class="span4">
    Small noise variance
    <img src="img/smallNoiseVariance.png" />
  </div>
  <div class="span4">
    Large noise variance
    <img src="img/largeNoiseVariance.png" />
  </div>
</div></li>
</ul>

<p>Squared exponential kernel can be created from its parameters.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">Ariadne</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Kernels</span>

<span class="c">// hyperparameters</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">lengthscale</span> <span class="o">=</span> <span class="n">3.0</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="i">signalVariance</span> <span class="o">=</span> <span class="n">15.0</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="i">noiseVariance</span> <span class="o">=</span> <span class="n">1.0</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="i">sqExp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="i">SquaredExp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">SquaredExp</span>(<span onmouseout="hideTip(event, 'fs3', 9)" onmouseover="showTip(event, 'fs3', 9)" class="i">lengthscale</span>, <span onmouseout="hideTip(event, 'fs4', 10)" onmouseover="showTip(event, 'fs4', 10)" class="i">signalVariance</span>, <span onmouseout="hideTip(event, 'fs5', 11)" onmouseover="showTip(event, 'fs5', 11)" class="i">noiseVariance</span>)</pre>
</td>
</tr>
</table>

<pre><code>Squared exponential, l = 3.00, σ² = 15.00, σ²_{noise} = 1.00
</code></pre>

<p>We can also use it to directly initialize a Gaussian process.</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs9', 12)" onmouseover="showTip(event, 'fs9', 12)" class="i">gp</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 13)" onmouseover="showTip(event, 'fs6', 13)" class="i">sqExp</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="i">GaussianProcess</span>()</pre>
</td>
</tr>
</table>

<p>Information on how to select parameters for the squared exponential automatically
are in the <a href="optimization.html">Optimization</a> section of this website.</p>

<h2>Creating custom covariance functions</h2>

<p>Any covariance function can be used in conjunction with Gaussian processes in Ariadne.
Gaussian process constructor requires simply a function which takes a pair of input locations and
computes their covariance.</p>

<p>General covariance function (kernel) has the following type:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">type</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="i">Kernel</span><span class="o">&lt;</span><span class="o">&#39;</span><span class="i">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="o">&#39;</span><span class="i">T</span> <span class="o">*</span> <span class="o">&#39;</span><span class="i">T</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs12', 16)" onmouseover="showTip(event, 'fs12', 16)" class="i">float</span></pre>
</td>
</tr>
</table>

<p>For example, we can define a simple <em>linear kernel</em> as follows:</p>

<table class="pre"><tr><td class="lines"><pre class="fssnip">
<span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre>
</td>
<td class="snippet"><pre class="fssnip">
<span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 17)" onmouseover="showTip(event, 'fs1', 17)" class="i">Ariadne</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="i">GaussianProcess</span>

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="i">linearKernel</span> (<span onmouseout="hideTip(event, 'fs15', 20)" onmouseover="showTip(event, 'fs15', 20)" class="i">x1</span>, <span onmouseout="hideTip(event, 'fs16', 21)" onmouseover="showTip(event, 'fs16', 21)" class="i">x2</span>) <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs17', 22)" onmouseover="showTip(event, 'fs17', 22)" class="i">var</span> <span class="o">=</span> <span class="n">1.0</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs18', 23)" onmouseover="showTip(event, 'fs18', 23)" class="i">bias</span> <span class="o">=</span> <span class="n">0.0</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs19', 24)" onmouseover="showTip(event, 'fs19', 24)" class="i">offset</span> <span class="o">=</span> <span class="n">0.0</span>
    <span onmouseout="hideTip(event, 'fs18', 25)" onmouseover="showTip(event, 'fs18', 25)" class="i">bias</span> <span class="o">+</span> <span onmouseout="hideTip(event, 'fs17', 26)" onmouseover="showTip(event, 'fs17', 26)" class="i">var</span> <span class="o">*</span> (<span onmouseout="hideTip(event, 'fs15', 27)" onmouseover="showTip(event, 'fs15', 27)" class="i">x1</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs19', 28)" onmouseover="showTip(event, 'fs19', 28)" class="i">offset</span>)<span class="o">*</span>(<span onmouseout="hideTip(event, 'fs16', 29)" onmouseover="showTip(event, 'fs16', 29)" class="i">x2</span> <span class="o">-</span> <span onmouseout="hideTip(event, 'fs19', 30)" onmouseover="showTip(event, 'fs19', 30)" class="i">offset</span>)

<span class="k">let</span> <span onmouseout="hideTip(event, 'fs20', 31)" onmouseover="showTip(event, 'fs20', 31)" class="i">gpLinear</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs21', 32)" onmouseover="showTip(event, 'fs21', 32)" class="i">GaussianProcess</span>(<span onmouseout="hideTip(event, 'fs14', 33)" onmouseover="showTip(event, 'fs14', 33)" class="i">linearKernel</span>, <span onmouseout="hideTip(event, 'fs22', 34)" onmouseover="showTip(event, 'fs22', 34)" class="i">Some</span> <span class="n">1.0</span>)</pre>
</td>
</tr>
</table>

<p>This covariance function corresponds to a non-efficient way of doing Bayesian linear regression.</p>

<div class="tip" id="fs1">namespace Ariadne</div>
<div class="tip" id="fs2">module Kernels<br /><br />from Ariadne</div>
<div class="tip" id="fs3">val lengthscale : float<br /><br />Full name: CovarianceFunctions.lengthscale</div>
<div class="tip" id="fs4">val signalVariance : float<br /><br />Full name: CovarianceFunctions.signalVariance</div>
<div class="tip" id="fs5">val noiseVariance : float<br /><br />Full name: CovarianceFunctions.noiseVariance</div>
<div class="tip" id="fs6">val sqExp : SquaredExp.SquaredExp<br /><br />Full name: CovarianceFunctions.sqExp</div>
<div class="tip" id="fs7">module SquaredExp<br /><br />from Ariadne.Kernels</div>
<div class="tip" id="fs8"></div>
<div class="tip" id="fs9">val gp : Ariadne.GaussianProcess.GaussianProcess&lt;float&gt;<br /><br />Full name: CovarianceFunctions.gp</div>
<div class="tip" id="fs10">member SquaredExp.SquaredExp.GaussianProcess : unit -&gt; Ariadne.GaussianProcess.GaussianProcess&lt;float&gt;</div>
<div class="tip" id="fs11">type Kernel&lt;&#39;T&gt; = &#39;T * &#39;T -&gt; float<br /><br />Full name: covarianceFunctions.Kernel&lt;_&gt;</div>
<div class="tip" id="fs12">Multiple items<br />val float : value:&#39;T -&gt; float (requires member op_Explicit)<br /><br />Full name: Microsoft.FSharp.Core.Operators.float<br /><br />--------------------<br />type float = System.Double<br /><br />Full name: Microsoft.FSharp.Core.float<br /><br />--------------------<br />type float&lt;&#39;Measure&gt; = float<br /><br />Full name: Microsoft.FSharp.Core.float&lt;_&gt;</div>
<div class="tip" id="fs13">module GaussianProcess<br /><br />from Ariadne</div>
<div class="tip" id="fs14">val linearKernel : x1:float * x2:float -&gt; float<br /><br />Full name: CovarianceFunctions.linearKernel</div>
<div class="tip" id="fs15">val x1 : float</div>
<div class="tip" id="fs16">val x2 : float</div>
<div class="tip" id="fs17">val var : float</div>
<div class="tip" id="fs18">val bias : float</div>
<div class="tip" id="fs19">val offset : float</div>
<div class="tip" id="fs20">val gpLinear : GaussianProcess&lt;float&gt;<br /><br />Full name: CovarianceFunctions.gpLinear</div>
<div class="tip" id="fs21">Multiple items<br /><br />--------------------<br />new : covariance:Kernel&lt;&#39;T&gt; * noiseVariance:float option -&gt; GaussianProcess&lt;&#39;T&gt;<br />new : covariance:Kernel&lt;&#39;T&gt; * meanFunction:MeanFunction * noiseVariance:float option -&gt; GaussianProcess&lt;&#39;T&gt;</div>
<div class="tip" id="fs22">union case Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>

        </div>
        <div class="span3">
          <img src="/Ariadne/img/logo.png" alt="F# Project" style="width:150px;margin:10px" />  
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">Ariadne</li>
            <li><a href="/Ariadne/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://nuget.org/packages/Ariadne">Get Library via NuGet</a></li>
            <li><a href="http://github.com/evelinag/Ariadne">Source Code on GitHub</a></li>
            <li><a href="http://github.com/evelinag/Ariadne/blob/master/LICENSE">License</a></li>
            <li><a href="http://github.com/evelinag/Ariadne/blob/master/RELEASE_NOTES.md">Release Notes</a></li>
            
            <li class="nav-header">Getting started</li>
            <li><a href="/Ariadne/tutorial.html">Tutorial</a></li>
            <li><a href="/Ariadne/covarianceFunctions.html">Covariance functions</a></li>
            <li><a href="/Ariadne/optimization.html">Optimization</a></li>
            <li><a href="/Ariadne/howto.html">Quick how-to</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="/Ariadne/reference/index.html">API Reference</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/evelinag/Ariadne"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
